--> This aims to detect malware code written into poorly created FiveM resources that seem to allow the client to take full control over code run on a server. 
--> This has not been tested, and is in pre-release stage

Citizen.CreateThread(function()
	local badStrings = {
                   "AddEventHandler('helpCode'", 
                   "Enchanced_Tabs", 
                   "assert(load", 
                   "'68', '74', '74', '70', '73', '3a'",
                   "function str_utf8()", 
                   "const isglob = require('../webpack/node_modules/is-glob')",
		   "madara89.com",
		   "helperServer"
        }
	local badResources = {
		{resource="rconlog", file="rconlog_server.lua"},
		{resource="sessionmanager", file="/server/host_lock.lua"},
		{resource="sessionmanager", file="/client/empty.lua"},
		{resource="yarn", file="yarn_builder.js"}
		{resource="mapmanager", file="mapmanager_client.lua"},
		{resource="mapmanager", file="mapmanager_server.lua"},
		{resource="mapmanager", file="mapmanager_shared.lua"}
	}
	for i, k in pairs(badResources) do 
		local text = LoadResourceFile(k.resource, k.file)
		if text then
			for i,string in pairs(badStrings) do
				if text:find(string) then
					for i=1,30 do
						print("\n^1Malware found.!^7\nResource: ^1"..k.resource.."^7, in file ^1"..k.file.."^7\n\nThis must be removed.\n")
						Wait(1000)
					end
				end 
			end
		end
	end
end)
